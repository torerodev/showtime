! Arista cEOS Spine1 Configuration
!
! Set hostname
hostname spine1
!
! Banner configuration
banner login 
+------------------------------------------------------------------------------+
|  WARNING: This is the MOST PRIVATE and AWESOME lab in the entire universe!   |
|                                                                              |
|  Unauthorized access is strictly prohibited and will result in:              |
|   - Your keyboard mysteriously converting to DVORAK layout                   |
|   - All your configs spontaneously translating to interpretive dance         |
|   - Network packets taking scenic routes and returning with vacation photos  |
|                                                                              |
|  Access and use are monitored by an army of caffeinated network engineers    |
|  who have nothing better to do than watch login attempts all day.            |
|                                                                              |
|  Proceed only if you have authorization... or really good snacks to share.   |
+ -----------------------------------------------------------------------------+
EOF
!
! Configure local users
username admin privilege 15 role network-admin secret admin
!
! Enable required services
service routing protocols model multi-agent
!
! Configure management interface
interface Management0
   description "Out of Band Management"
   ip address dhcp
   no shutdown
!
! Configure SSH access
management ssh
   no shutdown
   authentication mode password
   idle-timeout 60
   ip access-group MGMT-ACL in
!
! Create ACLs
ip access-list MGMT-ACL
   10 permit ip 192.168.0.0/16 any
   20 permit ip 10.0.0.0/8 any
   30 permit ip 172.16.0.0/12 any
   40 permit ip 198.18.1.0/24 any
   45 permit ip 1.1.1.0/24 any
   50 deny ip any any
!
! Configure VTY lines
line vty
   transport input ssh
   exec-timeout 30
!
! Configure system services
ip http server
ip http secure-server
ip http client source-interface Management0
!
! Configure system settings
clock timezone UTC
ip domain lookup
ip icmp rate-limit unreachable 100
!
! Configure DNS
ip name-server 8.8.8.8
ip name-server 8.8.4.4
ip domain-name example.com
!
! Configure NTP
ntp server 0.pool.ntp.org prefer
ntp server 1.pool.ntp.org
ntp source Management0
!
! Configure logging
logging console informational
logging monitor informational
logging buffered 10000 informational
logging host 192.168.1.100
logging source-interface Management0
!
! Configure SNMP
snmp-server community public ro
snmp-server community private rw
snmp-server location "Data Center 1, Rack 1"
snmp-server contact "Network Operations Center <noc@example.com>"
!
! Enable routing
ip routing
!
! Configure Loopback for BGP Router ID
interface Loopback0
   description "BGP Router ID"
   ip address 10.0.0.1/32
!
! Configure Spine-to-Leaf interfaces (Layer 3)
interface Ethernet1
   description "Link to leaf1"
   no switchport
   ip address 10.1.1.0/31
   mtu 9214
   no shutdown
!
interface Ethernet2
   description "Link to leaf2"
   no switchport
   ip address 10.1.1.2/31
   mtu 9214
   no shutdown
!
interface Ethernet3
   description "Link to leaf3"
   no switchport
   ip address 10.1.1.4/31
   mtu 9214
   no shutdown
!
interface Ethernet4
   description "Link to leaf4"
   no switchport
   ip address 10.1.1.6/31
   mtu 9214
   no shutdown
!
! BGP Configuration for Underlay and Overlay
router bgp 65100
   router-id 10.0.0.1
   no bgp default ipv4-unicast
   maximum-paths 4 ecmp 4
   distance bgp 20 200 200
   !
   neighbor LEAF_UNDERLAY peer group
   neighbor LEAF_UNDERLAY send-community extended
   !
   neighbor LEAF_OVERLAY peer group
   neighbor LEAF_OVERLAY update-source Loopback0
   neighbor LEAF_OVERLAY ebgp-multihop 3
   neighbor LEAF_OVERLAY send-community extended
   !
   neighbor 10.1.1.1 peer group LEAF_UNDERLAY
   neighbor 10.1.1.1 remote-as 65201
   neighbor 10.1.1.1 description leaf1
   !
   neighbor 10.1.1.3 peer group LEAF_UNDERLAY
   neighbor 10.1.1.3 remote-as 65202
   neighbor 10.1.1.3 description leaf2
   !
   neighbor 10.1.1.5 peer group LEAF_UNDERLAY
   neighbor 10.1.1.5 remote-as 65203
   neighbor 10.1.1.5 description leaf3
   !
   neighbor 10.1.1.7 peer group LEAF_UNDERLAY
   neighbor 10.1.1.7 remote-as 65204
   neighbor 10.1.1.7 description leaf4
   !
   neighbor 10.0.1.1 peer group LEAF_OVERLAY
   neighbor 10.0.1.1 remote-as 65201
   neighbor 10.0.1.1 description leaf1_overlay
   !
   neighbor 10.0.1.2 peer group LEAF_OVERLAY
   neighbor 10.0.1.2 remote-as 65202
   neighbor 10.0.1.2 description leaf2_overlay
   !
   neighbor 10.0.1.3 peer group LEAF_OVERLAY
   neighbor 10.0.1.3 remote-as 65203
   neighbor 10.0.1.3 description leaf3_overlay
   !
   neighbor 10.0.1.4 peer group LEAF_OVERLAY
   neighbor 10.0.1.4 remote-as 65204
   neighbor 10.0.1.4 description leaf4_overlay
   !
   address-family ipv4
      neighbor LEAF_UNDERLAY activate
      network 10.0.0.1/32
   !
   address-family evpn
      neighbor LEAF_OVERLAY activate
!
! Enable features
lldp run
!
! Save configuration
copy running-config startup-config